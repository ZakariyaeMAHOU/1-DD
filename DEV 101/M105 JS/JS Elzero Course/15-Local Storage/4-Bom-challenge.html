<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        .container {
            width: 100%;
            padding: 20px 10%;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .container .form {
            display: flex;
            flex-direction: row;
            justify-content: space-evenly;
            align-items: center;
            width: 80%;
            margin: 20px;
            height: 60px;
            background-color: #999;
            border-radius: 7px;
        }

        .container .form .input {
            width: 70%;
            height: 40%;
            border-radius: 7px;
            border: none;
        }

        .container .form .add {
            width: 20%;
            height: 40%;
            border-radius: 7px;
            text-align: center;
            font-weight: 600;
            color: white;
            background-color: red;
            border: none;
            cursor: pointer;
        }

        .container .tasks {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            width: 80%;
            margin: 0 20px;
            border-radius: 7px;
            border: 1px solid #000;
        }

        .container .tasks .task {
            width: 90%;
            height: 60px;
            margin: 20px;
            border-radius: 7px;
            border: none;
            background-color: #999;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 10px;
        }

        .container .tasks .task p {
            width: 80%;
            height: 40%;
            border-radius: 7px;
            border: none;
            background-color: #fff;
            padding: 5px;
        }

        .container .tasks .task .delete {
            width: 15%;
            height: 40%;
            border-radius: 7px;
            text-align: center;
            font-weight: 500;
            font-size: x-small;
            color: white;
            background-color: red;
            border: none;
            cursor: pointer;
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="form">
            <input type="text" class="input">
            <input type="submit" class="add" value="Add Task">
        </div>
        <div class="tasks">
        </div>
    </div>
    <script>
        // get elements
        let input = document.querySelector(".input");
        let addBtn = document.querySelector(".add");
        let tasksContainer = document.querySelector(".tasks");

        // create Array to include all tasks
        let allTasks = JSON.parse(localStorage.getItem("tasks")) || [];;

        // checking for tasks in localStorage and print on document
        // if (window.localStorage.getItem("tasks") !== null) {
        for (let i = 0; i < allTasks.length; i++) {
            let taskContainer = document.createElement("div");
            taskContainer.classList = "task";
            taskContainer.id = allTasks[i].id;

            let taskContent = document.createElement('p');
            taskContent.textContent = allTasks[i].title;

            let deleteBtn = document.createElement("input");
            deleteBtn.classList = "delete";
            deleteBtn.type = "submit"
            deleteBtn.value = "Delete";
            deleteBtn.addEventListener("click", function () {
                this.parentElement.remove();

                let taskId = this.parentElement.id;
                allTasks = allTasks.filter(task => task.id != taskId);

                localStorage.setItem("tasks", JSON.stringify(allTasks));
            });

            //Add Elements(taskContainer & deleteBtn) to task
            taskContainer.appendChild(taskContent);
            taskContainer.appendChild(deleteBtn);

            //add task to tasks
            tasksContainer.appendChild(taskContainer);
        }
        // }

        // add a new task to document and localStorage
        addBtn.addEventListener("click", addTask);
        function addTask() {
            if (input.value.trim() !== "") {
                allTasks.push({ id: Date.now(), title: input.value });
                //add to localStorage
                window.localStorage.setItem("tasks", JSON.stringify(allTasks));
                //add task to document
                let taskContainer = document.createElement("div");
                taskContainer.classList = "task";
                taskContainer.id = allTasks[allTasks.length - 1].id;

                let taskContent = document.createElement('p');
                taskContent.textContent = input.value;

                let deleteBtn = document.createElement("input");
                deleteBtn.classList = "delete";
                deleteBtn.type = "submit";
                deleteBtn.value = "Delete";
                deleteBtn.addEventListener("click", function () {
                    this.parentElement.remove();

                    let taskId = this.parentElement.id;
                    allTasks = allTasks.filter(task => task.id != taskId);

                    localStorage.setItem("tasks", JSON.stringify(allTasks));
                });


                //Add Elements(taskContainer & deleteBtn) to task
                taskContainer.appendChild(taskContent);
                taskContainer.appendChild(deleteBtn);

                //add task to tasks
                tasksContainer.appendChild(taskContainer);

                input.value = "";
            }
        }
    </script>
</body>

</html>